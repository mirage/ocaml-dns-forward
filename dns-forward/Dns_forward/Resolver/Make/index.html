<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (dns-forward.Dns_forward.Resolver.Make)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../../index.html">dns-forward</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Dns_forward.Resolver.Make</span></h1></header><div class="doc"><p>Construct a DNS resolver which will use the given <code class="code">Client</code> Implementation
to contact upstream servers, and the given <code class="code">Time</code> implementation to handle
timeouts.</p></div><h3 class="heading">Parameters</h3><div><div class="spec argument" id="argument-3-Clock"><a href="#argument-3-Clock" class="anchor"></a><div class="def argument"><code>Clock : Mirage_clock_lwt.MCLOCK</code></div><div class="doc"></div></div><div class="spec argument" id="argument-2-Time"><a href="#argument-2-Time" class="anchor"></a><div class="def argument"><code>Time : Mirage_time_lwt.S</code></div><div class="doc"></div></div><div class="spec argument" id="argument-1-Client"><a href="#argument-1-Client" class="anchor"></a><div class="def argument"><code><a href="argument-1-Client/index.html">Client</a> : <a href="../../Rpc/Client/index.html#module-type-S">Rpc.Client.S</a></code></div><div class="doc"></div></div></div><h3 class="heading">Signature</h3><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-clock"><a href="#type-clock" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>clock</code><code><span class="keyword"> = </span><a href="index.html#argument-3-Clock">Clock</a>.t</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-address"><a href="#type-address" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>address</code><code><span class="keyword"> = </span><a href="../../Config/Address/index.html#type-t">Config.Address.t</a></code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-message_cb"><a href="#type-message_cb" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>message_cb</code><code><span class="keyword"> = </span>?&#8288;src:<a href="index.html#type-address">address</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;dst:<a href="index.html#type-address">address</a> <span class="keyword">&#8209;&gt;</span> buf:Cstruct.t <span class="keyword">&#8209;&gt;</span> unit <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code><code></code></div><div class="doc"><p>A callback called per message, which permits recording and analysis.
If an address is unknown (e.g. it is selected by the kernel when routing
the packets) then the corresponding argument will be omitted</p></div></div><div class="spec val" id="val-create"><a href="#val-create" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create : ?&#8288;local_names_cb:(Dns.Packet.question <span class="keyword">&#8209;&gt;</span> Dns.Packet.rr list option Lwt.t) <span class="keyword">&#8209;&gt;</span> ?&#8288;message_cb:<a href="index.html#type-message_cb">message_cb</a> <span class="keyword">&#8209;&gt;</span> <a href="../../Config/index.html#type-t">Config.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-clock">clock</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> Lwt.t</code></div><div class="doc"><p>Construct a resolver given some configuration</p></div></div><div class="spec val" id="val-destroy"><a href="#val-destroy" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>destroy : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code></div><div class="doc"><p>Destroy and free all resources associated with the resolver</p></div></div><div class="spec val" id="val-answer"><a href="#val-answer" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>answer : Cstruct.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Cstruct.t <a href="../../Error/index.html#type-t">Error.t</a></code></div><div class="doc"><p>Process a query by first checking whether the name can be satisfied
locally via the <code class="code">local_names_cb</code> and failing that, sending it to
upstream servers according to the resolver configuration. The call
will block forever if no server with a timeout is chosen; the client
should be prepared to timeout and cancel the thread.</p></div></div></body></html>